---
layout: default
---

{% if page.profile and page.profile.image %}
  {%- assign profile_image_path = page.profile.image | prepend: 'assets/img/' -%}
  <!-- Preload critical profile image -->
  <link rel="preload" as="image" href="{{ profile_image_path | relative_url }}" />
  
  <!-- Preload all switching images for smooth transitions -->
  {% if page.profile.images and page.profile.images.size > 1 %}
    {% for image_file in page.profile.images %}
      {% unless forloop.first %}
        {%- assign image_path = image_file | prepend: 'assets/img/' -%}
        <link rel="preload" as="image" href="{{ image_path | relative_url }}" />
      {% endunless %}
    {% endfor %}
  {% endif %}
{% endif %}

<!-- about.html -->
<div class="post">
  <header class="post-header">
    <h1 class="post-title">
      {% if site.title == "blank" -%}<span class="font-weight-bold">{{ site.first_name }}</span> {{ site.middle_name }} {{ site.last_name }}{%- else -%}{{ site.title }}{%- endif %}
    </h1>
    <p class="desc">{{ page.subtitle }}</p>
  </header>

  <article>
    {% if page.profile -%}
    <div class="profile float-{%- if page.profile.align == 'left' -%}left{%- else -%}right{%- endif -%}">
      {%- if page.profile.image %}
        {%- assign profile_image_path = page.profile.image | prepend: 'assets/img/' -%}
        {%- assign profile_image_class = page.profile.image_circular | default: false -%}

        <!-- Simple profile image container -->
        <div class="simple-profile-container">
          <!-- Main image wrapper -->
          <div class="profile-wrapper {% if profile_image_class %}circular{% else %}rounded{% endif %}">
            <!-- Simple image display for proper switching -->
            <img 
              src="{{ profile_image_path | relative_url }}" 
              class="profile-image" 
              alt="Profile image"
              id="profileImage"
              loading="eager"
              decoding="async"
            >
          </div>
          
          <!-- Only show navigation if multiple images -->
          {% if page.profile.images and page.profile.images.size > 1 %}
          <div class="image-nav-container">
            <div class="image-nav">
              <!-- Left navigation -->
              <button class="nav-btn nav-left" id="navLeft" aria-label="Previous image">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="15 18 9 12 15 6"></polyline>
                </svg>
              </button>
              
              <!-- Image indicators -->
              <div class="image-indicators" id="imageIndicators">
                {% for image_file in page.profile.images %}
                <div class="indicator {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></div>
                {% endfor %}
              </div>
              
              <!-- Right navigation -->
              <button class="nav-btn nav-right" id="navRight" aria-label="Next image">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <polyline points="9 18 15 12 9 6"></polyline>
                </svg>
              </button>
            </div>
          </div>
          {% endif %}
          
          <!-- Hidden images for preloading -->
          {% if page.profile.images and page.profile.images.size > 1 %}
          <div style="display: none;" aria-hidden="true">
            {% for image_file in page.profile.images %}
              {%- assign image_path = image_file | prepend: 'assets/img/' -%}
              <img 
                src="{{ image_path | relative_url }}" 
                id="preload-image-{{ forloop.index0 }}"
                alt="Preload image {{ forloop.index }}"
              >
            {% endfor %}
          </div>
          {% endif %}
        </div>

      {% endif -%}
      {%- if page.profile.address %}
      <div class="address">
        {{ page.profile.address }}
      </div>
      {%- endif %}

      {%- if page.profile.note %}
      <div class="profile-note">
        {{ page.profile.note }}
      </div>
      {%- endif %}
    </div>
    {%- endif %}

    <div class="clearfix">
      {{ content }}
    </div>

    <!-- News -->
    {% if page.news and site.announcements.enabled -%}
      <h2><a href="{{ '/news/' | relative_url }}" style="color: inherit;">News</a></h2>
      {%- include news.html limit=true %}
    {%- endif %}

    <!-- Latest posts -->
    {% if page.latest_posts -%}
      <h2><a href="{{ '/blog/' | relative_url }}" style="color: inherit;">Latest Posts</a></h2>
      {%- include latest_posts.html %}
    {%- endif %}

    <!-- Selected papers -->
    {% if page.selected_papers -%}
      <h2>Selected Publications <a href="{{ '/publications/' | relative_url }}" style="font-size: 1.4rem;">[view all]</a></h2>
      {%- include selected_papers.html %}
    {%- endif %}

    <!-- Service -->
    {% if page.services -%}
      <h2>Services</h2>
      {%- include services.html %}
    {%- endif %}
    
    <!-- Social -->
    {%- if page.social %}
      <div class="social">
        <div class="contact-icons">
          {% include social.html %}
        </div>

        <div class="contact-note">
          {{ site.contact_note }}
        </div>

      </div>
    {%- endif %}
    
  </article>
</div>

<style>
  .profile-note {
    font-size: 0.62rem;
    margin-top: 0px;
  }
  
  /* Simple profile image styles */
  .simple-profile-container {
    position: relative;
    margin-bottom: 10px;
  }
  
  .profile-wrapper {
    position: relative;
    width: 100%;
    overflow: hidden;
    box-shadow: 0 3px 12px rgba(0, 0, 0, 0.12);
    margin-bottom: 18px;
    aspect-ratio: 1/1; /* 强制正方形容器 */
  }
  
  .profile-wrapper.circular {
    border-radius: 50%;
  }
  
  .profile-wrapper.rounded {
    border-radius: 12px;
  }
  
  .profile-image {
    width: 100%;
    height: 100%; /* 填满容器 */
    display: block;
    object-fit: cover; /* 确保图片填满容器且保持比例 */
    object-position: center; /* 居中显示 */
    transition: opacity 0.6s ease;
  }
  
  /* Simple navigation styles */
  .image-nav-container {
    margin-top: 12px;
  }
  
  .image-nav {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
  }
  
  .nav-btn {
    background: rgba(0, 0, 0, 0.1);
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    color: rgba(0, 0, 0, 0.6);
  }
  
  .nav-btn:hover {
    background: rgba(0, 0, 0, 0.15);
    color: rgba(0, 0, 0, 0.8);
    transform: scale(1.05);
  }
  
  .nav-btn:active {
    transform: scale(0.95);
  }
  
  .image-indicators {
    display: flex;
    gap: 8px;
    align-items: center;
  }
  
  .indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.2);
    cursor: pointer;
    transition: all 0.3s ease;
  }
  
  .indicator.active {
    background: rgba(0, 0, 0, 0.6);
    transform: scale(1.2);
  }
  
  .indicator:hover {
    background: rgba(0, 0, 0, 0.4);
    transform: scale(1.1);
  }
  
  /* Dark mode support */
  html[data-theme="dark"] .nav-btn {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.6);
  }
  
  html[data-theme="dark"] .nav-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.8);
  }
  
  html[data-theme="dark"] .indicator {
    background: rgba(255, 255, 255, 0.2);
  }
  
  html[data-theme="dark"] .indicator.active {
    background: rgba(255, 255, 255, 0.6);
  }
  
  html[data-theme="dark"] .indicator:hover {
    background: rgba(255, 255, 255, 0.4);
  }
</style>

<script>
  // Simple image switching logic
  let currentImageIndex = 0;
  let totalImages = 0;
  let imagePaths = [];
  let autoSwitchInterval;
  
  // Initialize when DOM is loaded
  document.addEventListener('DOMContentLoaded', function() {
    const profileImage = document.getElementById('profileImage');
    const indicators = document.getElementById('imageIndicators');
    const navLeft = document.getElementById('navLeft');
    const navRight = document.getElementById('navRight');
    
    // Get all image paths from preloaded images
    const preloadImages = document.querySelectorAll('[id^="preload-image-"]');
    totalImages = preloadImages.length;
    
    console.log('Found', totalImages, 'images for switching');
    
    // If only one image, no need for navigation
    if (totalImages <= 1) {
      console.log('Only one image found, no switching needed');
      return;
    }
    
    // Collect image paths and preload efficiently
    preloadImages.forEach((img, index) => {
      imagePaths[index] = img.src;
      console.log('Image', index + ':', img.src);
    });
    
    // Images are already preloaded in HTML head, no need for additional preloading
    
    // Setup navigation
    if (navLeft && navRight) {
      navLeft.addEventListener('click', () => switchToImage('prev'));
      navRight.addEventListener('click', () => switchToImage('next'));
      console.log('Navigation buttons set up');
    }
    
    // Setup indicator clicks
    if (indicators) {
      const indicatorDots = indicators.querySelectorAll('.indicator');
      indicatorDots.forEach((dot, index) => {
        dot.addEventListener('click', () => switchToImage(index));
      });
      console.log('Indicator dots set up');
    }
    
    // Start auto switching
    startAutoSwitch();
    console.log('Auto switching started');
    
    // Pause auto switch on hover
    const container = document.querySelector('.simple-profile-container');
    if (container) {
      container.addEventListener('mouseenter', stopAutoSwitch);
      container.addEventListener('mouseleave', startAutoSwitch);
    }
  });
  
  function switchToImage(target) {
    if (totalImages <= 1) return;
    
    let newIndex;
    
    if (target === 'next') {
      newIndex = (currentImageIndex + 1) % totalImages;
    } else if (target === 'prev') {
      newIndex = (currentImageIndex - 1 + totalImages) % totalImages;
    } else if (typeof target === 'number') {
      newIndex = target;
    } else {
      return;
    }
    
    if (newIndex === currentImageIndex) return;
    
    console.log('Switching from image', currentImageIndex, 'to', newIndex);
    console.log('New image path:', imagePaths[newIndex]);
    
    // Update image
    const profileImage = document.getElementById('profileImage');
    if (profileImage && imagePaths[newIndex]) {
      profileImage.style.opacity = '0';
      
      setTimeout(() => {
        profileImage.src = imagePaths[newIndex];
        profileImage.style.opacity = '1';
        console.log('Image switched successfully');
      }, 300);
    } else {
      console.error('Failed to switch image:', profileImage ? 'Image element found' : 'No image element', imagePaths[newIndex] ? 'Path exists' : 'No image path');
    }
    
    // Update indicators
    updateIndicators(newIndex);
    
    currentImageIndex = newIndex;
    
    // Restart auto switch timer
    restartAutoSwitch();
  }
  
  function updateIndicators(activeIndex) {
    const indicators = document.querySelectorAll('.indicator');
    indicators.forEach((indicator, index) => {
      if (index === activeIndex) {
        indicator.classList.add('active');
      } else {
        indicator.classList.remove('active');
      }
    });
  }
  
  function startAutoSwitch() {
    if (totalImages <= 1) return;
    
    stopAutoSwitch(); // Clear any existing interval
    
    // 根据当前图片索引设置不同的显示时间
    let displayTime;
    if (currentImageIndex === 0) {
      displayTime = 15000; // main image show more time
    } else {
      displayTime = 5000; // other images show less time
    }
    
    console.log('Starting auto switch timer for', displayTime, 'ms (current index:', currentImageIndex, ')');
    
    autoSwitchInterval = setTimeout(() => {
      console.log('Auto switch triggered');
      switchToImage('next');
    }, displayTime);
  }
  
  function stopAutoSwitch() {
    if (autoSwitchInterval) {
      clearInterval(autoSwitchInterval);
      autoSwitchInterval = null;
    }
  }
  
  function restartAutoSwitch() {
    stopAutoSwitch();
    startAutoSwitch();
  }
</script>